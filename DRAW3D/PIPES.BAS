Function FOV(COORD1,COORD2)
    DISTANCE = 240
    ANGLE = Atn(COORD1 / (DISTANCE + COORD2))
    FOV = (Tan(ANGLE) * DISTANCE)
End Function

SUB DRAWDOT
    PIXEL(CENTRE.X+FOV(DOTX,DOTZ),CENTRE.Y+FOV(DOTY,DOTZ)) = GREEN
END SUB

FUNCTION NEWDIR
    DO
        DO
            NEWDIR = FIX(RND()*7)-3
        UNTIL NEWDIR <> 0
    UNTIL ABS(NEWDIR) <> ABS(CURRDIR)
END FUNCTION

SUB MOVEDOT
    IF CURRDIR = -3 THEN
        DOTZ = DOTZ-1
    ELSEIF CURRDIR = -2 THEN
        DOTY = DOTY - 1
    ELSEIF CURRDIR = -1 THEN
        DOTX = DOTX - 1
    ELSEIF CURRDIR = 1 THEN
        DOTX = DOTX + 1
    ELSEIF CURRDIR = 2 THEN
        DOTY = DOTY + 1
    ELSEIF CURRDIR = 3 THEN
        DOTZ = DOTZ + 1
    ENDIF
END SUB

CENTRE.X = (MM.HRES/2)
CENTRE.Y = (MM.VRES/2)
DOTX = 0
DOTY = 0
DOTZ = 0
CURRDIR = NEWDIR
DO
    MOVEDOT
    IF ABS(DOTX) OR ABS(DOTY) OR ABS(DOTZ) > 400 THEN
        NEWDIR
        DRAWDOT
    ELSE
        DRAWDOT
    ENDIF
LOOP
